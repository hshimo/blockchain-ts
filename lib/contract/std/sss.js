"use strict";

Object.defineProperty(exports, "__esModule", {
  value: true
});
exports.default = exports.sssCombine = exports.sssSplit = void 0;

var _buffer = require("../../blockchain/crypto/buffer");

var sss = require("shamirs-secret-sharing");

var sssSplit = function sssSplit(raw, shares, threshold) {
  var shareKeys = sss.split(Buffer.from(raw), {
    shares: shares,
    threshold: threshold
  });
  return shareKeys.map(function (key) {
    return (0, _buffer.bufferToHex)(key);
  });
};

exports.sssSplit = sssSplit;

var sssCombine = function sssCombine(shares) {
  return sss.combine(shares.map(function (share) {
    return (0, _buffer.hexToBuffer)(share);
  })).toString();
};

exports.sssCombine = sssCombine;
var _default = {
  sssSplit: sssSplit,
  sssCombine: sssCombine
};
exports.default = _default;
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi4uLy4uLy4uL3NyYy9jb250cmFjdC9zdGQvc3NzLnRzIl0sIm5hbWVzIjpbInNzcyIsInJlcXVpcmUiLCJzc3NTcGxpdCIsInJhdyIsInNoYXJlcyIsInRocmVzaG9sZCIsInNoYXJlS2V5cyIsInNwbGl0IiwiQnVmZmVyIiwiZnJvbSIsIm1hcCIsImtleSIsInNzc0NvbWJpbmUiLCJjb21iaW5lIiwic2hhcmUiLCJ0b1N0cmluZyJdLCJtYXBwaW5ncyI6Ijs7Ozs7OztBQUFBOztBQUVBLElBQU1BLEdBQUcsR0FBR0MsT0FBTyxDQUFDLHdCQUFELENBQW5COztBQUVPLElBQU1DLFFBQVEsR0FBRyxTQUFYQSxRQUFXLENBQUNDLEdBQUQsRUFBY0MsTUFBZCxFQUE4QkMsU0FBOUIsRUFBb0Q7QUFDMUUsTUFBTUMsU0FBZ0IsR0FBR04sR0FBRyxDQUFDTyxLQUFKLENBQVVDLE1BQU0sQ0FBQ0MsSUFBUCxDQUFZTixHQUFaLENBQVYsRUFBNEI7QUFDbkRDLElBQUFBLE1BQU0sRUFBTkEsTUFEbUQ7QUFFbkRDLElBQUFBLFNBQVMsRUFBVEE7QUFGbUQsR0FBNUIsQ0FBekI7QUFJQSxTQUFPQyxTQUFTLENBQUNJLEdBQVYsQ0FBYyxVQUFBQyxHQUFHO0FBQUEsV0FBSSx5QkFBWUEsR0FBWixDQUFKO0FBQUEsR0FBakIsQ0FBUDtBQUNELENBTk07Ozs7QUFRQSxJQUFNQyxVQUFVLEdBQUcsU0FBYkEsVUFBYSxDQUFDUixNQUFELEVBQXNCO0FBQzlDLFNBQU9KLEdBQUcsQ0FBQ2EsT0FBSixDQUFZVCxNQUFNLENBQUNNLEdBQVAsQ0FBVyxVQUFBSSxLQUFLO0FBQUEsV0FBSSx5QkFBWUEsS0FBWixDQUFKO0FBQUEsR0FBaEIsQ0FBWixFQUFxREMsUUFBckQsRUFBUDtBQUNELENBRk07OztlQUlRO0FBQUViLEVBQUFBLFFBQVEsRUFBUkEsUUFBRjtBQUFZVSxFQUFBQSxVQUFVLEVBQVZBO0FBQVosQyIsInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7IGJ1ZmZlclRvSGV4LCBoZXhUb0J1ZmZlciB9IGZyb20gXCIuLi8uLi9ibG9ja2NoYWluL2NyeXB0by9idWZmZXJcIjtcblxuY29uc3Qgc3NzID0gcmVxdWlyZShcInNoYW1pcnMtc2VjcmV0LXNoYXJpbmdcIik7XG5cbmV4cG9ydCBjb25zdCBzc3NTcGxpdCA9IChyYXc6IHN0cmluZywgc2hhcmVzOiBudW1iZXIsIHRocmVzaG9sZDogbnVtYmVyKSA9PiB7XG4gIGNvbnN0IHNoYXJlS2V5czogYW55W10gPSBzc3Muc3BsaXQoQnVmZmVyLmZyb20ocmF3KSwge1xuICAgIHNoYXJlcyxcbiAgICB0aHJlc2hvbGRcbiAgfSk7XG4gIHJldHVybiBzaGFyZUtleXMubWFwKGtleSA9PiBidWZmZXJUb0hleChrZXkpKTtcbn07XG5cbmV4cG9ydCBjb25zdCBzc3NDb21iaW5lID0gKHNoYXJlczogc3RyaW5nW10pID0+IHtcbiAgcmV0dXJuIHNzcy5jb21iaW5lKHNoYXJlcy5tYXAoc2hhcmUgPT4gaGV4VG9CdWZmZXIoc2hhcmUpKSkudG9TdHJpbmcoKTtcbn07XG5cbmV4cG9ydCBkZWZhdWx0IHsgc3NzU3BsaXQsIHNzc0NvbWJpbmUgfTtcbiJdfQ==